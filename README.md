
---

##  Кастомный пул потоков на Java (курсовая по многопоточности)

###  Описание

В рамках курсового проекта реализован собственный пул потоков с поддержкой:

* ручного управления очередями,
* логированием всех ключевых этапов,
* параметризуемыми настройками пула,
* механизмом обработки отказов при перегрузке,
* интерфейсом совместимым с `Executor` и `CompletableFuture`.

Цель — симуляция работы высоконагруженного серверного приложения, в котором требуется гибкость, отказоустойчивость и масштабируемость потоков без использования `ThreadPoolExecutor`.

---

###  Основные параметры пула

| Параметр          | Описание                                             |
| ----------------- | ---------------------------------------------------- |
| `corePoolSize`    | Минимальное количество потоков                       |
| `maxPoolSize`     | Максимальное количество потоков                      |
| `keepAliveTime`   | Время простоя потока перед завершением               |
| `queueSize`       | Максимальный размер очереди задач                    |
| `minSpareThreads` | Минимальное количество свободных (резервных) потоков |

---

###  Возможности и логика работы

* **Балансировка задач** — используется Round Robin по отдельным очередям, прикреплённым к потокам.
* **Обработка отказов** — при переполнении очереди задачи отклоняются с логом (`[Rejected] ...`).
* **Рабочие потоки (`Worker`)**:

  * забирают задачи из своей очереди;
  * завершаются по `keepAliveTime`, если не активны и не входят в `corePoolSize`;
  * логируют всё: запуск, выполнение задач и завершение.
* **`ThreadFactory`** — создаёт потоки с уникальными именами (`MyPool-worker-X`) и логирует их создание и завершение.

---

###  Демонстрация

В `Main.java` реализован запуск пула с параметрами:

```java
corePoolSize = 2
maxPoolSize = 4
queueSize = 5
keepAliveTime = 5 секунд
minSpareThreads = 1
```

* В пул отправляются симулированные задачи (`Runnable`), выполняющие `Thread.sleep(...)` и логирующие свою работу.
* При перегрузке (подаче >9 задач) фиксируется отказ.
* После `shutdown()` все задачи завершаются, потоки корректно освобождаются.

---

###  Сборка и запуск

```bash
gradle build
gradle run
```

---

###  Структура проекта

```bash
src/
  └── custompool/
        ├── CustomThreadPool.java     # основной пул
        ├── CustomThreadFactory.java  # фабрика потоков
        ├── TaskQueue.java            # обертка над очередью задач
        ├── Worker.java               # рабочие потоки
        └── Main.java                 # демо-программа
```

---

###  Логи из работы

Примеры:

```
[ThreadFactory] Creating new thread: MyPool-worker-1
[Pool] Task accepted into queue: ...
[Worker] MyPool-worker-1 executes ...
[Task 1] Started
[Task 1] Finished
[Worker] MyPool-worker-1 idle timeout, stopping.
[Worker] MyPool-worker-1 terminated.
[Pool] Shutdown initiated.
```

---

###  Заключение

Пул потоков реализован с нуля, без использования `ThreadPoolExecutor`. Поддерживает расширенные настройки и отказоустойчивость. Соответствует требованиям задания и демонстрирует ключевые принципы многопоточности в Java.


